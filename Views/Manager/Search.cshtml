@model IEnumerable<Books>
@if (TempData["Message"] != null)
{
    <div class="alert alert-danger">
        @TempData["Message"]
    </div>
}
<form asp-action="Search" method="post">
    <input type="text" name="name" placeholder="Enter book name" />
    <button type="submit">Search</button>
</form>

<table class="table">
    <thead>
        <tr>
            <th>Book's Name</th>
            <th>Category</th>
            <th>Is Available</th>
            @if(User.IsInRole("Admin")||User.IsInRole("Assistant"))
            {
            <th>Details</th>
            }
        </tr>
    </thead>
    <tbody>
        @foreach (var u in Model)
        {
            <tr>
                <td>@u.Name</td>
                <td>@u.category.Name</td>
                <td>
                    @if (u.IsAvailable)
                    {
                        <div class="alert alert-success">Available</div>

                    }
                    else
                    {
                        <div class="alert alert-danger">Not Available</div>

                    }
                </td>
                 @if(User.IsInRole("Admin")||User.IsInRole("Assistant")){
                <td>
                    <!-- 3 Nokta Sembolü (ellipsis) ile butonları açma -->
                    <button class="btn-ellipsis" onclick="toggleButtons('@u.BooksId')">
                        <div class="ellipsis-dot"></div>
                        <div class="ellipsis-dot"></div>
                        <div class="ellipsis-dot"></div>
                    </button>

                    <!-- Buton Grubu (Başlangıçta gizli) -->
                    <div class="btn-group" id="buttonGroup-@u.BooksId" style="display: none;">
                        <!-- Butonlar alt alta sıralandı -->
                        <a class="btn btn-sm" asp-action="toUser" asp-route-id="@u.BooksId">To User</a>
                        <form method="post" asp-action="toLibrary" asp-route-id="@u.BooksId"
                            onsubmit="return confirm('Kitabı teslim almak istediğinize emin misiniz?');" class="d-inline">
                            <button type="submit" class="btn btn-sm btn-danger">Get Back</button>
                        </form>
                        <a class="btn btn-sm" asp-action="Edit" asp-route-id="@u.BooksId">Edit</a>
                        <form method="post" asp-action="Delete" asp-route-id="@u.BooksId"
                            onsubmit="return confirm('Kitabı silmek istediğinize emin misiniz?');" class="d-inline">
                            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                        </form>
                    </div>
                </td>}
            </tr>
        }
    </tbody>
</table>

<!-- JavaScript ile butonları göster/gizle -->
<script>
    function toggleButtons(bookId) {
        var buttonGroup = document.getElementById('buttonGroup-' + bookId);
        if (buttonGroup.style.display === "none") {
            buttonGroup.style.display = "block";
        } else {
            buttonGroup.style.display = "none";
        }
    }
</script>

<!-- Butonların görünür olmasını sağlamak için CSS -->
<style>
    /* Ellipsis butonunu stilize et */
    .btn-ellipsis {
        background-color: #fff;
        color: #000;
        border: none;
        font-size: 20px;
        cursor: pointer;
        padding: 5px 10px;
        margin: 0;
        display: inline-block;
        text-align: center;
        border-radius: 3px;
    }

    .ellipsis-dot {
        width: 3px;
        height: 3px;
        margin: 2px;
        border-radius: 50%;
        background-color: #000;
    }

    .btn-ellipsis:hover {
        background-color: #f1f1f1;
    }

    /* Buton grubu */
    .btn-group {
        position: absolute;
        /* Sayfa yapısını değiştirmeden görünür hale getir */
        display: none;
        background-color: #fff;
        padding: 5px;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        z-index: 10;
        margin-top: 5px;
        /* Üstten biraz boşluk bırak */
        width: 150px;
    }

    /* Butonları alt alta diz */
    .btn-group .btn {
        display: block;
        width: 100%;
        padding: 8px;
        font-size: 14px;
        color: #000;
        background-color: #fff;
        border: none;
        text-align: left;
        margin-bottom: 5px;
        /* Butonlar arasında boşluk ekleyelim */
    }

    /* Hover ve click efektleri */
    .btn-group .btn:hover,
    .btn-group .btn:active,
    .btn-ellipsis:active {
        background-color: #e6e6e6;
    }

    .btn-group .btn:focus {
        outline: none;
    }
</style>
